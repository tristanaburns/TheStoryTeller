{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Character Metadata Schema",
  "description": "Defines the structure for character tracking in The Shadow Team Chronicles.",
  "type": "object",
  "properties": {
    "id": {
      "type": "string",
      "format": "uuid",
      "description": "A globally unique identifier (UUID v4) for this character."
    },
    "name": {
      "type": "string",
      "description": "The character's full name or primary identifier."
    },
    "aliases": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Alternative names or identities used by the character."
    },
    "description": {
      "type": "string",
      "description": "A detailed description of the character's appearance, personality, and other notable traits."
    },
    "status": {
      "type": "string",
      "enum": ["alive", "dead", "unknown", "transformed", "missing"],
      "description": "The current status of the character in the narrative."
    },
    "role": {
      "type": "string",
      "enum": ["protagonist", "antagonist", "supporting", "mentor", "villain", "neutral", "background"],
      "description": "The character's role in the story."
    },
    "timeline": {
      "type": "object",
      "description": "Tracks the character's presence in the narrative timeline",
      "properties": {
        "first_appearance": {
          "type": "object",
          "description": "Details about when this character first appears in the narrative",
          "properties": {
            "timestamp": {
              "type": "string",
              "format": "date-time",
              "description": "Exact date and time when the character first appears"
            },
            "volume": {
              "type": "string",
              "description": "The volume in which the character first appears"
            },
            "chapter": {
              "type": "string",
              "description": "The chapter in which the character first appears"
            },
            "scene_id": {
              "type": "string",
              "format": "uuid",
              "description": "The UUID of the scene where the character first appears"
            }
          },
          "required": ["timestamp", "scene_id"]
        },
        "last_appearance": {
          "type": "object",
          "description": "Details about when this character last appears in the narrative (if applicable)",
          "properties": {
            "timestamp": {
              "type": "string",
              "format": "date-time",
              "description": "Exact date and time when the character last appears"
            },
            "volume": {
              "type": "string",
              "description": "The volume in which the character last appears"
            },
            "chapter": {
              "type": "string",
              "description": "The chapter in which the character last appears"
            },
            "scene_id": {
              "type": "string",
              "format": "uuid",
              "description": "The UUID of the scene where the character last appears"
            },
            "reason": {
              "type": "string",
              "description": "Reason for the character's departure from the narrative (death, mission, etc.)"
            }
          }
        },
        "appearances": {
          "type": "array",
          "description": "List of all scenes in which this character appears",
          "items": {
            "type": "object",
            "properties": {
              "scene_id": {
                "type": "string",
                "format": "uuid",
                "description": "The UUID of the scene where the character appears"
              },
              "timestamp": {
                "type": "string",
                "format": "date-time",
                "description": "The timestamp of the scene in narrative chronology"
              },
              "volume": {
                "type": "string",
                "description": "The volume of this appearance"
              },
              "chapter": {
                "type": "string",
                "description": "The chapter of this appearance"
              },
              "narrative_iteration_id": {
                "type": "string",
                "format": "uuid",
                "description": "Reference to the narrative iteration where this appearance occurs"
              },
              "significance": {
                "type": "string",
                "enum": ["major", "supporting", "cameo", "mentioned"],
                "description": "The character's level of significance in this particular scene"
              },
              "character_development": {
                "type": "array",
                "description": "Key character development moments in this scene",
                "items": {
                  "type": "string"
                }
              },
              "relationships_affected": {
                "type": "array",
                "description": "Other character relationships affected in this scene",
                "items": {
                  "type": "object",
                  "properties": {
                    "character_id": {
                      "type": "string",
                      "format": "uuid",
                      "description": "ID of the other character involved"
                    },
                    "change": {
                      "type": "string",
                      "enum": ["improved", "worsened", "complicated", "initiated", "terminated"],
                      "description": "How the relationship changed"
                    },
                    "description": {
                      "type": "string",
                      "description": "Brief description of what happened"
                    }
                  },
                  "required": ["character_id", "change"]
                }
              }
            },
            "required": ["scene_id", "timestamp", "significance"]
          }
        }
      },
      "required": ["first_appearance", "appearances"]
    },
    "affiliations": {
      "type": "array",
      "description": "Groups, factions, or organizations the character belongs to",
      "items": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Name of the group or faction"
          },
          "role": {
            "type": "string",
            "description": "Character's role within the group"
          },
          "start_timestamp": {
            "type": "string",
            "format": "date-time",
            "description": "When the character joined this affiliation"
          },
          "end_timestamp": {
            "type": "string",
            "format": "date-time",
            "description": "When the character left this affiliation (if applicable)"
          },
          "current": {
            "type": "boolean",
            "description": "Whether the character is currently affiliated with this group"
          }
        },
        "required": ["name", "start_timestamp", "current"]
      }
    },
    "relationships": {
      "type": "array",
      "description": "Character's relationships with other characters",
      "items": {
        "type": "object",
        "properties": {
          "character_id": {
            "type": "string",
            "format": "uuid",
            "description": "ID of the related character"
          },
          "relationship_type": {
            "type": "string",
            "description": "Nature of the relationship (ally, enemy, family, etc.)"
          },
          "dynamic": {
            "type": "string",
            "description": "Brief description of their dynamic"
          },
          "first_met": {
            "type": "object",
            "properties": {
              "scene_id": {
                "type": "string",
                "format": "uuid",
                "description": "ID of the scene where they first met"
              },
              "timestamp": {
                "type": "string",
                "format": "date-time",
                "description": "When they first met in narrative chronology"
              }
            }
          },
          "relationship_milestones": {
            "type": "array",
            "description": "Key moments in the relationship's development",
            "items": {
              "type": "object",
              "properties": {
                "description": {
                  "type": "string",
                  "description": "What happened"
                },
                "scene_id": {
                  "type": "string",
                  "format": "uuid",
                  "description": "Scene where this milestone occurred"
                },
                "timestamp": {
                  "type": "string",
                  "format": "date-time",
                  "description": "When this milestone occurred"
                }
              },
              "required": ["description", "scene_id", "timestamp"]
            }
          },
          "current_status": {
            "type": "string",
            "enum": ["ally", "enemy", "neutral", "complex", "unknown"],
            "description": "Current state of the relationship"
          }
        },
        "required": ["character_id", "relationship_type", "current_status"]
      }
    },
    "character_arc": {
      "type": "object",
      "description": "The character's development arc throughout the narrative",
      "properties": {
        "starting_state": {
          "type": "string",
          "description": "Description of the character's state at first appearance"
        },
        "current_state": {
          "type": "string",
          "description": "Description of the character's current state"
        },
        "goal": {
          "type": "string",
          "description": "The character's primary goal or motivation"
        },
        "key_development_scenes": {
          "type": "array",
          "description": "Scenes that significantly changed or developed this character",
          "items": {
            "type": "object",
            "properties": {
              "scene_id": {
                "type": "string",
                "format": "uuid",
                "description": "ID of the development scene"
              },
              "timestamp": {
                "type": "string",
                "format": "date-time",
                "description": "When this development occurred"
              },
              "description": {
                "type": "string",
                "description": "What changed about the character"
              },
              "significance": {
                "type": "string",
                "enum": ["major", "minor", "pivotal"],
                "description": "How significant this change was to their arc"
              }
            },
            "required": ["scene_id", "description", "significance"]
          }
        }
      },
      "required": ["starting_state", "current_state"]
    },
    "attributes": {
      "type": "object",
      "description": "Character's abilities, skills, and physical attributes",
      "properties": {
        "physical": {
          "type": "object",
          "description": "Physical characteristics and attributes",
          "additionalProperties": true
        },
        "skills": {
          "type": "array",
          "description": "Notable skills and abilities",
          "items": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string",
                "description": "Name of the skill"
              },
              "description": {
                "type": "string",
                "description": "Description of the skill"
              },
              "acquisition_scene_id": {
                "type": "string",
                "format": "uuid",
                "description": "Scene where this skill was acquired or first demonstrated"
              },
              "proficiency": {
                "type": "string",
                "enum": ["novice", "competent", "expert", "master", "legendary"],
                "description": "Character's proficiency level with this skill"
              }
            },
            "required": ["name", "description", "proficiency"]
          }
        },
        "equipment": {
          "type": "array",
          "description": "Notable equipment, weapons, or items associated with the character",
          "items": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string",
                "description": "Name of the item"
              },
              "description": {
                "type": "string",
                "description": "Description of the item"
              },
              "acquisition_scene_id": {
                "type": "string",
                "format": "uuid",
                "description": "Scene where this item was acquired"
              },
              "current_status": {
                "type": "string",
                "enum": ["possessed", "lost", "destroyed", "transferred"],
                "description": "Current status of this item"
              }
            },
            "required": ["name", "description", "current_status"]
          }
        }
      }
    },
    "multimedia_references": {
      "type": "array",
      "description": "References to multimedia elements related to this character",
      "items": {
        "type": "object",
        "properties": {
          "reference_id": {
            "type": "string",
            "description": "Identifier referencing the multimedia element"
          },
          "type": {
            "type": "string",
            "enum": ["image", "video", "audio", "model"],
            "description": "The type of multimedia element"
          },
          "description": {
            "type": "string",
            "description": "Description of the multimedia content"
          },
          "scene_id": {
            "type": "string",
            "format": "uuid",
            "description": "ID of the scene where this multimedia was generated/used"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "description": "When this multimedia element was created/used"
          }
        },
        "required": ["reference_id", "type", "description"]
      }
    },
    "tags": {
      "type": "array",
      "description": "Categorization tags for the character",
      "items": {
        "type": "object",
        "properties": {
          "key": {
            "type": "string",
            "description": "Tag category"
          },
          "value": {
            "type": "string",
            "description": "Tag value"
          }
        },
        "required": ["key", "value"]
      }
    },
    "notes": {
      "type": "array",
      "description": "Additional notes about the character",
      "items": {
        "type": "object",
        "properties": {
          "author": {
            "type": "string",
            "description": "Who added this note"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "description": "When this note was added"
          },
          "text": {
            "type": "string",
            "description": "The note content"
          }
        },
        "required": ["author", "timestamp", "text"]
      }
    }
  },
  "required": ["id", "name", "description", "status", "timeline", "tags"]
}
